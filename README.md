# üß© –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ: –£—á–µ–±–Ω—ã–π —Ç—Ä–µ–Ω–∞–∂—ë—Ä Kafka –¥–ª—è QA

## 1. –¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞

–°–æ–∑–¥–∞—Ç—å —É—á–µ–±–Ω—ã–π –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω—ã–π —Å—Ç–µ–Ω–¥, –∏–º–∏—Ç–∏—Ä—É—é—â–∏–π –±–∏–∑–Ω–µ—Å-–ø—Ä–æ—Ü–µ—Å—Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è HR-–ø—Ä–æ—Ñ–∏–ª—è–º–∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤.
–ó–∞–¥–∞—á–∞ —Å—Ç–µ–Ω–¥–∞ ‚Äî –ø–æ–∑–≤–æ–ª–∏—Ç—å –Ω–∞—á–∏–Ω–∞—é—â–∏–º QA –∏–Ω–∂–µ–Ω–µ—Ä–∞–º –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ü–µ—Å—Å –æ–±–º–µ–Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏ —á–µ—Ä–µ–∑ Kafka:

* –æ—Ç–ø—Ä–∞–≤–∫—É —Å–æ–±—ã—Ç–∏–π (–ø—Ä–æ–¥—é—Å–µ—Ä),
* –æ–±—Ä–∞–±–æ—Ç–∫—É —Å–æ–æ–±—â–µ–Ω–∏–π —Ç—Ä–µ–º—è –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–º–∏ –∫–æ–Ω—Å—å—é–º–µ—Ä–∞–º–∏,
* –∑–∞–ø–∏—Å—å –∏ –ø—Ä–æ—Å–º–æ—Ç—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ –ë–î –∏ UI,
* —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–∏–ø–∏—á–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤: –ø–æ—Ä—è–¥–æ–∫ –¥–æ—Å—Ç–∞–≤–∫–∏, –¥—É–±–ª–∏–∫–∞—Ç—ã, DLQ, –ª–∞–≥–∏ –∏ —Ç. –¥.

---

## 2. –û–±—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç                 | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                                            | –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏                            |
|---------------------------|-------------------------------------------------------|---------------------------------------|
| Kafka (1 –±—Ä–æ–∫–µ—Ä)          | –ë—Ä–æ–∫–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏–π (Kafka KRaft Mode, –±–µ–∑ ZooKeeper)    | bitnami/kafka:latest                  |
| Kafka UI                  | –í–µ–±-–ø–∞–Ω–µ–ª—å –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ç–æ–ø–∏–∫–æ–≤ –∏ —Å–æ–æ–±—â–µ–Ω–∏–π          | provectuslabs/kafka-ui                |
| Producer API              | REST API –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–±—ã—Ç–∏–π (FastAPI)               | Python 3.12, FastAPI, Confluent-Kafka |
| Consumer A                | –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è –æ –¥–æ–ª–∂–Ω–æ—Å—Ç—è—Ö (hr.positions)      | Python 3.12, Confluent-Kafka          |
| Consumer B                | –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ª–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (hr.personal)              | Python 3.12, Confluent-Kafka          |
| Consumer C                | –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∏—Å—Ç–æ—Ä–∏—é —Ä–∞–±–æ—Ç—ã (hr.history)              | Python 3.12, Confluent-Kafka          |
| PostgreSQL (–æ—Ç–¥–µ–ª—å–Ω–∞—è –ë–î) | –•—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π, –ø—Ä–æ—Ñ–∏–ª–µ–π —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤, –∏—Å—Ç–æ—Ä–∏–∏ –∏ DLQ | PostgreSQL 15+                        |

–í—Å–µ —Å–µ—Ä–≤–∏—Å—ã —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞—é—Ç—Å—è –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º docker-compose —Å—Ç–µ–∫–µ —Å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–π —Å–µ—Ç—å—é, —á—Ç–æ–±—ã –Ω–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤–∞—Ç—å —Å –¥—Ä—É–≥–∏–º–∏
–ø—Ä–æ–µ–∫—Ç–∞–º–∏ –Ω–∞ VDS.

---

## 3. –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

### 3.1. Producer API

* –ü–æ–¥–Ω—è—Ç—å —Å–µ—Ä–≤–∏—Å –Ω–∞ FastAPI (–ø–æ—Ä—Ç 7011).
* –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ç—Ä–∏ POST-—ç–Ω–¥–ø–æ–∏–Ω—Ç–∞:

    * /produce/position ‚Üí —Ç–æ–ø–∏–∫ hr.positions
    * /produce/personal ‚Üí —Ç–æ–ø–∏–∫ hr.personal
    * /produce/history ‚Üí —Ç–æ–ø–∏–∫ hr.history
* –ö–∞–∂–¥—ã–π —ç–Ω–¥–ø–æ–∏–Ω—Ç –ø—Ä–∏–Ω–∏–º–∞–µ—Ç JSON-—Ç–µ–ª–æ (payload) —Å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º–∏ –ø–æ–ª—è–º–∏:

    * employee_id ‚Äî —Å—Ç—Ä–æ–∫–∞
    * message_id ‚Äî UUID (–¥–ª—è –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏)
    * –û—Å—Ç–∞–ª—å–Ω—ã–µ –ø–æ–ª—è ‚Äî —Å–º. –Ω–∏–∂–µ.
* Producer –∫–æ–¥–∏—Ä—É–µ—Ç payload –≤ JSON –∏ –ø—É–±–ª–∏–∫—É–µ—Ç –≤ Kafka —Å –∫–ª—é—á–æ–º employee_id.
* –ù–∞—Å—Ç—Ä–æ–π–∫–∏ Kafka –±–µ—Ä—É—Ç—Å—è –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è:

KAFKA_BOOTSTRAP=qa-kafka:9092
PRODUCER_CLIENT_ID=qa-producer

#### –ü—Ä–∏–º–µ—Ä—ã payload:

1) /produce/position

{
"message_id": "uuid-1",
"employee_id": "e-1024",
"title": "QA Engineer",
"department": "Quality Assurance",
"grade": "Middle",
"effective_from": "2025-10-01"
}

2) /produce/personal

{
"message_id": "uuid-2",
"employee_id": "e-1024",
"first_name": "Anna",
"last_name": "Ivanova",
"birth_date": "1994-06-12",
"contacts": { "email": "anna@example.com", "phone": "+33..." }
}

3) /produce/history

{
"message_id": "uuid-3",
"employee_id": "e-1024",
"company": "Acme Corp",
"position": "QA",
"period": { "from": "2022-07-01", "to": "2025-09-30" },
"stack": ["Python", "Pytest", "Postman"]
}

---

### 3.2. Consumer-—Å–µ—Ä–≤–∏—Å—ã

–ö–∞–∂–¥—ã–π –∫–æ–Ω—Å—å—é–º–µ—Ä ‚Äî –æ—Ç–¥–µ–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–º group_id.
–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –æ–±—â–∞—è:

KAFKA_BOOTSTRAP=qa-kafka:9092
TOPIC=hr.positions|hr.personal|hr.history
GROUP_ID=consumer_positions|consumer_personal|consumer_history
PG_DSN=postgresql://kafka_lab_user:password@db_host:5432/qa_kafka_lab

#### –õ–æ–≥–∏–∫–∞ –∫–æ–Ω—Å—å—é–º–µ—Ä–∞:

1. –ü–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ Kafka, —Å–ª—É—à–∞–µ—Ç —Å–≤–æ–π —Ç–æ–ø–∏–∫.
2. –ü—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏—è:

    * –í–∞–ª–∏–¥–∏—Ä—É–µ—Ç JSON.
    * –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ message_id –≤ —Ç–∞–±–ª–∏—Ü–µ lab.kafka_events ‚Üí –µ—Å–ª–∏ —É–∂–µ –±—ã–ª–æ ‚Äî –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç (–∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å).
    * –ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç ¬´—Å—ã—Ä–æ–µ¬ª —Å–æ–±—ã—Ç–∏–µ –≤ —Ç–∞–±–ª–∏—Ü—É lab.kafka_events (topic, key, payload, offset, received_at).
    * –í –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞ —Ç–æ–ø–∏–∫–∞ –æ–±–Ω–æ–≤–ª—è–µ—Ç/–≤—Å—Ç–∞–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ:

* positions ‚Üí –æ–±–Ω–æ–≤–ª—è–µ—Ç –¥–æ–ª–∂–Ω–æ—Å—Ç—å –∏ –æ—Ç–¥–µ–ª –≤ lab.employee_profile
    * personal ‚Üí –æ–±–Ω–æ–≤–ª—è–µ—Ç –ª–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ lab.employee_profile
    * history ‚Üí –¥–æ–±–∞–≤–ª—è–µ—Ç –∑–∞–ø–∏—Å—å –≤ lab.employment_history

3. –í —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏ –ø—Ä–∏ —Ä–∞–∑–±–æ—Ä–µ JSON ‚Äî –ø–∏—à–µ—Ç –∑–∞–ø–∏—Å—å –≤ lab.kafka_dlq.

---

## 4. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ë–î

–ë–∞–∑–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ—Ç–¥–µ–ª—å–Ω–æ–π, –Ω–µ –ø–µ—Ä–µ—Å–µ–∫–∞—é—â–µ–π—Å—è —Å –¥—Ä—É–≥–∏–º–∏ –ø—Ä–æ–µ–∫—Ç–∞–º–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ.

–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö: qa_kafka_lab
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: kafka_lab_user
–°—Ö–µ–º–∞: lab

SQL-–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è (–≤—ã–ø–æ–ª–Ω–∏—Ç—å —á–µ—Ä–µ–∑ –º–∏–≥—Ä–∞—Ü–∏–∏ –∏–ª–∏ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞):

CREATE SCHEMA IF NOT EXISTS lab;

CREATE TABLE lab.kafka_events (
id BIGSERIAL PRIMARY KEY,
message_id UUID UNIQUE,
topic TEXT NOT NULL,
msg_key TEXT,
partition INT,
offset BIGINT,
payload JSONB NOT NULL,
received_at TIMESTAMPTZ DEFAULT now()
);

CREATE TABLE lab.kafka_dlq (
id BIGSERIAL PRIMARY KEY,
topic TEXT NOT NULL,
msg_key TEXT,
payload JSONB NOT NULL,
error TEXT NOT NULL,
received_at TIMESTAMPTZ DEFAULT now()
);

CREATE TABLE lab.employee_profile (
employee_id TEXT PRIMARY KEY,
first_name TEXT,
last_name TEXT,
birth_date DATE,
email TEXT,
phone TEXT,
title TEXT,
department TEXT,
grade TEXT,
effective_from DATE,
updated_at TIMESTAMPTZ DEFAULT now()
);

CREATE TABLE lab.employment_history (
id BIGSERIAL PRIMARY KEY,
employee_id TEXT NOT NULL,
company TEXT NOT NULL,
position TEXT,
period_from DATE,
period_to DATE,
stack TEXT[],
created_at TIMESTAMPTZ DEFAULT now()
);

---

## 5. –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ –¥–µ–ø–ª–æ–π

### Docker-Compose —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

–°–æ–∑–¥–∞—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é /opt/qa-kafka-lab/ —Å —Ñ–∞–π–ª–∞–º–∏:

/opt/qa-kafka-lab/
‚îú‚îÄ docker-compose.yml
‚îú‚îÄ producer/
‚îÇ ‚îú‚îÄ Dockerfile
‚îÇ ‚îú‚îÄ requirements.txt
‚îÇ ‚îî‚îÄ app.py
‚îú‚îÄ consumer-positions/
‚îÇ ‚îú‚îÄ Dockerfile
‚îÇ ‚îî‚îÄ app.py
‚îú‚îÄ consumer-personal/
‚îÇ ‚îú‚îÄ Dockerfile
‚îÇ ‚îî‚îÄ app.py
‚îú‚îÄ consumer-history/
‚îÇ ‚îú‚îÄ Dockerfile
‚îÇ ‚îî‚îÄ app.py
‚îî‚îÄ init_db/
‚îî‚îÄ init.sql

### Docker Compose

* –í—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –æ–±—ä–µ–¥–∏–Ω—è—é—Ç—Å—è –≤ —Å–µ—Ç—å qa-kafka-net.
* Kafka –Ω–µ –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å ports: –Ω–∞—Ä—É–∂—É (—Ç–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–∏ —Å–µ—Ç–∏).
* Kafka UI –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ http://localhost:7008 (–∏–ª–∏ —á–µ—Ä–µ–∑ Nginx /simulators/kafka-ui/).
* Producer –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ http://localhost:7011 (–∏–ª–∏ /simulators/kafka-producer/).

–ü–æ—Ä—Ç—ã 7008 –∏ 7011 —Å–æ–≥–ª–∞—Å–æ–≤–∞—Ç—å, —á—Ç–æ–±—ã –Ω–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤–∞–ª–∏ —Å —É–∂–µ –∑–∞–Ω—è—Ç—ã–º–∏.

---

## 6. –ù–µ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è          | –¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ                                                                                                    |
|--------------------|---------------------------------------------------------------------------------------------------------------|
| –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å       | Kafka –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –Ω–∞—Ä—É–∂—É; —Ç–æ–ª—å–∫–æ UI –∏ Producer –ø—Ä–æ–∫—Å–∏—Ä—É—é—Ç—Å—è —á–µ—Ä–µ–∑ Nginx.                                   |
| –ò–∑–æ–ª—è—Ü–∏—è           | –ü—Ä–æ–µ–∫—Ç –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ /opt/qa-kafka-lab/, –æ—Ç–¥–µ–ª—å–Ω–∞—è docker-—Å–µ—Ç—å, –æ—Ç–¥–µ–ª—å–Ω–∞—è –±–∞–∑–∞ qa_kafka_lab.         |
| –û—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å | –ü—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏ –∫–æ–Ω—Å—å—é–º–µ—Ä–∞ –¥–∞–Ω–Ω—ã–µ –Ω–µ —Ç–µ—Ä—è—é—Ç—Å—è ‚Äî –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ –æ–Ω –¥–æ—á–∏—Ç—ã–≤–∞–µ—Ç –æ—Ñ—Ñ—Å–µ—Ç—ã.                            |
| –ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å    | –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ —Ç–æ–≥–æ –∂–µ message_id –Ω–µ –¥–æ–ª–∂–Ω–∞ –¥—É–±–ª–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø–∏—Å–∏ –≤ employee_profile –∏–ª–∏ employment_history. |
| –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ        | –í—Å–µ —Å–µ—Ä–≤–∏—Å—ã –≤—ã–≤–æ–¥—è—Ç –ª–æ–≥–∏ –≤ stdout (–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ docker logs -f), –±–µ–∑ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.                     |
| –£—Å—Ç–∞–Ω–æ–≤–∫–∞          | –û–¥–Ω–æ–∫–æ–º–∞–Ω–¥–Ω—ã–π –¥–µ–ø–ª–æ–π: docker compose up -d --build                                                            |
| –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å      | –°–æ–≤–º–µ—Å—Ç–∏–º–æ —Å Docker >= 24 –∏ PostgreSQL >= 15                                                                  |
| –†–µ—Å—É—Ä—Å—ã            | –ü—Ä–æ–µ–∫—Ç –ª—ë–≥–∫–∏–π: ‚â§ 1 –ì–ë RAM, ‚â§ 1 CPU –Ω–∞ VDS.                                                                    |

---

## 7. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

1. –í README.md –æ–ø–∏—Å–∞—Ç—å:

* —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–æ–µ–∫—Ç–∞,
    * –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è,
    * –∫–æ–º–∞–Ω–¥—ã –∑–∞–ø—É—Å–∫–∞/–æ—Å—Ç–∞–Ω–æ–≤–∫–∏,
    * –ø—Ä–∏–º–µ—Ä—ã curl –∑–∞–ø—Ä–æ—Å–æ–≤ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.

2. –°–¥–µ–ª–∞—Ç—å –ø—Ä–æ—Å—Ç–æ–π health-endpoint /health –≤ Producer –∏ Consumer-–∞—Ö.
3. –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å SQL-—Å–∫—Ä–∏–ø—Ç init_db/init.sql –¥–ª—è –ø–µ—Ä–≤–∏—á–Ω–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è —Å—Ö–µ–º—ã –∏ —Ç–∞–±–ª–∏—Ü.
4. –ü–æ–¥–¥–µ—Ä–∂–∞—Ç—å —Ä—É—á–Ω—É—é –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫—É –¥–∞–Ω–Ω—ã—Ö: docker compose down -v –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ—á–∏—â–∞–µ—Ç —Ö—Ä–∞–Ω–∏–ª–∏—â–µ Kafka –∏ –ë–î (–¥–ª—è QA-–ø—Ä–∞–∫—Ç–∏–∫–∏
   ¬´—Å –Ω—É–ª—è¬ª).

---

## 8. –ü—Ä–∏–º–µ—Ä—ã —Ç–µ—Å—Ç–æ–≤—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –¥–ª—è QA (–¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ä–µ–∞–ª–∏–∑—É–µ–º—ã –Ω–∞ —ç—Ç–æ–º —Å—Ç–µ–Ω–¥–µ)

| ‚Ññ | –°—Ü–µ–Ω–∞—Ä–∏–π                                                                                                                       | –¶–µ–ª—å –ø—Ä–æ–≤–µ—Ä–∫–∏                                       |
|---|--------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------|
| 1 | –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–±—ã—Ç–∏–µ /produce/personal, —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ consumer-personal –ø–æ–ª—É—á–∏–ª —Å–æ–æ–±—â–µ–Ω–∏–µ –∏ –∑–∞–ø–∏—Å—å –ø–æ—è–≤–∏–ª–∞—Å—å –≤ employee_profile. | –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–∑–æ–≤–æ–≥–æ –æ–±–º–µ–Ω–∞.                           |
| 2 | –û—Ç–ø—Ä–∞–≤–∏—Ç—å 3 —Å–æ–±—ã—Ç–∏—è –ø–æ–¥—Ä—è–¥ –¥–ª—è –æ–¥–Ω–æ–≥–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ ‚Äî –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—Ä—è–¥–æ–∫ –≤ kafka_events.                                           | –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –ø–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –ø–æ—Ä—è–¥–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π. |
| 3 | –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–±—ã—Ç–∏–µ —Å —Ç–µ–º –∂–µ message_id ‚Äî –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –¥—É–±–ª–∏–∫–∞—Ç –Ω–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω –ø–æ–≤—Ç–æ—Ä–Ω–æ.                                         | –ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å.                                    |
| 4 | –û—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π JSON ‚Äî –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—è–≤–ª–µ–Ω–∏–µ –≤ kafka_dlq.                                                                 | –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫.                                   |
| 5 | –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å consumer-history, –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–±—ã—Ç–∏—è, –ø–æ—Ç–æ–º –∑–∞–ø—É—Å—Ç–∏—Ç—å ‚Äî —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –æ–Ω –¥–æ—á–∏—Ç–∞–ª –æ—Ç—Å—Ç–∞–≤—à–∏–µ.                         | –ü–æ–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–∏ –æ—Ñ—Ñ–ª–∞–π–Ω–µ.                             |

---

## 9. –ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏—ë–º–∫–∏

‚úÖ –í—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –ø–æ–¥–Ω–∏–º–∞—é—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫ –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π.
‚úÖ Kafka UI –¥–æ—Å—Ç—É–ø–µ–Ω (–∏ –≤–∏–¥–Ω—ã —Ç–æ–ø–∏–∫–∏ hr.positions, hr.personal, hr.history).
‚úÖ –°–æ–æ–±—â–µ–Ω–∏—è, –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–¥—é—Å–µ—Ä–æ–º, –ø–æ–ø–∞–¥–∞—é—Ç –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —Ç–æ–ø–∏–∫–∏ –∏ —Ç–∞–±–ª–∏—Ü—ã –ë–î.
‚úÖ –ü–æ–≤—Ç–æ—Ä–Ω—ã–µ message_id –Ω–µ –¥—É–±–ª–∏—Ä—É—é—Ç –∑–∞–ø–∏—Å–∏.
‚úÖ –û—à–∏–±–æ—á–Ω—ã–µ JSON-—Å–æ–±—ã—Ç–∏—è —Ñ–∏–∫—Å–∏—Ä—É—é—Ç—Å—è –≤ kafka_dlq.
‚úÖ –õ–æ–≥–∏ —á–∏—Ç–∞–µ–º—ã —á–µ—Ä–µ–∑ docker compose logs -f.
‚úÖ –ü—Ä–∏ docker compose down -v –≤—Å—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —á–∏—Å—Ç–∏—Ç—Å—è.

---

## 10. –ë—É–¥—É—â–µ–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ (–Ω–µ –≤ —Ä–∞–º–∫–∞—Ö –ø–µ—Ä–≤–æ–π –≤–µ—Ä—Å–∏–∏)

* DLQ-–∫–æ–Ω—Å—å—é–º–µ—Ä (–ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –æ–±—Ä–∞—Ç–Ω–æ –≤ —Ä–∞–±–æ—á–∏–µ —Ç–æ–ø–∏–∫–∏).
* –û–±—â–∏–π "Events Dashboard" (–ø—Ä–æ—Å—Ç–∞—è –≤–µ–±-—Å—Ç—Ä–∞–Ω–∏—Ü–∞ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Å–æ–±—ã—Ç–∏–π).
* –ü–æ–¥–¥–µ—Ä–∂–∫–∞ Redpanda –∫–∞–∫ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã Kafka.
* –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å–ª—É—á–∞–π–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π –¥–ª—è –Ω–∞–≥—Ä—É–∑–∫–∏ (10 000 —Å–æ–æ–±—â–µ–Ω–∏–π).

–û—Ç–¥–µ–ª—å–Ω–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –ø–æ payload:

(https://chatgpt.com/s/t_68eb545255b08191aa02310fd499f54e)

# üì¶ –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ —Å–æ–æ–±—â–µ–Ω–∏–π (payload)

## –û–±—â–∏–µ –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è –≤—Å–µ—Ö —Å–æ–æ–±—â–µ–Ω–∏–π

–ö–∞–∂–¥–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ, –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º–æ–µ —á–µ—Ä–µ–∑ /produce/*, –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å:

| –ü–æ–ª–µ        | –¢–∏–ø           | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ | –û–ø–∏—Å–∞–Ω–∏–µ                                                                                 | –ü—Ä–∏–º–µ—Ä                                 |
|-------------|---------------|-------------|------------------------------------------------------------------------------------------|----------------------------------------|
| message_id  | string (UUID) | ‚úÖ           | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Å–æ–±—ã—Ç–∏—è. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏.                      | "2a5b0df2-3d2f-4a6a-b5a9-3cbdf509b1f5" |
| employee_id | string        | ‚úÖ           | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞, –ø–æ –∫–æ—Ç–æ—Ä–æ–º—É –æ–±—ä–µ–¥–∏–Ω—è—é—Ç—Å—è –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ä–∞–∑–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤. | "e-1024"                               |

> ‚ö†Ô∏è –ï—Å–ª–∏ message_id –∏–ª–∏ employee_id –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∏–ª–∏ –∏–º–µ–µ—Ç –Ω–µ–≤–µ—Ä–Ω—ã–π —Ç–∏–ø ‚Äî —Å–æ–æ–±—â–µ–Ω–∏–µ —Å—á–∏—Ç–∞–µ—Ç—Å—è –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–º –∏ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å
> –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ DLQ —Å –æ—à–∏–±–∫–æ–π missing_required_field –∏–ª–∏ invalid_type.

---

## 1Ô∏è‚É£ /produce/personal ‚Üí –¢–æ–ø–∏–∫ hr.personal

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:

–ü–µ—Ä–µ–¥–∞—á–∞ –ª–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ (–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è).

### –ü–æ–ª—è:

| –ü–æ–ª–µ       | –¢–∏–ø                 | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ                                 | –û–ø–∏—Å–∞–Ω–∏–µ                             | –ü—Ä–∏–º–µ—Ä                                                    |
|------------|---------------------|---------------------------------------------|--------------------------------------|-----------------------------------------------------------|
| first_name | string              | ‚úÖ                                           | –ò–º—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞                       | "Anna"                                                    |
| last_name  | string              | ‚úÖ                                           | –§–∞–º–∏–ª–∏—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞                   | "Ivanova"                                                 |
| birth_date | string (YYYY-MM-DD) | ‚úÖ                                           | –î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ ISO          | "1994-06-12"                                              |
| contacts   | object              | ‚öôÔ∏è (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Å–∞–º–æ –ø–æ–ª–µ, –Ω–æ –Ω–µ –≤—Å–µ –∫–ª—é—á–∏) | –ö–æ–Ω—Ç–∞–∫—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è (email, phone) | { "email": "anna@example.com", "phone": "+33-123-45-67" } |

#### –í–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞:

| ‚Ññ | –£—Å–ª–æ–≤–∏–µ                                      | –†–µ–∑—É–ª—å—Ç–∞—Ç                |
|---|----------------------------------------------|--------------------------|
| 1 | first_name –∏–ª–∏ last_name –ø—É—Å—Ç—ã ("" –∏–ª–∏ null) | ‚ùå invalid_value          |
| 2 | birth_date –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç YYYY-MM-DD       | ‚ùå invalid_date_format    |
| 3 | contacts –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é               | ‚ùå missing_required_field |
| 4 | contacts.email –Ω–µ–≤–∞–ª–∏–¥–µ–Ω (–Ω–µ—Ç @)             | ‚ùå invalid_email          |
| 5 | contacts.phone –Ω–µ —Å—Ç—Ä–æ–∫–∞                     | ‚ùå invalid_type           |
| 6 | –í—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è –µ—Å—Ç—å –∏ –≤–∞–ª–∏–¥–Ω—ã         | ‚úÖ OK                     |

---

## 2Ô∏è‚É£ /produce/position ‚Üí –¢–æ–ø–∏–∫ hr.positions

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:

–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –¥–æ–ª–∂–Ω–æ—Å—Ç–∏ –∏ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞.

### –ü–æ–ª—è:

| –ü–æ–ª–µ           | –¢–∏–ø                 | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ | –û–ø–∏—Å–∞–Ω–∏–µ                         | –ü—Ä–∏–º–µ—Ä              |
|----------------|---------------------|-------------|----------------------------------|---------------------|
| title          | string              | ‚úÖ           | –ù–∞–∑–≤–∞–Ω–∏–µ –¥–æ–ª–∂–Ω–æ—Å—Ç–∏               | "QA Engineer"       |
| department     | string              | ‚úÖ           | –ü–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ                    | "Quality Assurance" |
| grade          | string (enum)       | ‚öôÔ∏è          | –£—Ä–æ–≤–µ–Ω—å –≥—Ä–µ–π–¥–∞ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞        | "Middle"            |
| effective_from | string (YYYY-MM-DD) | ‚úÖ           | –î–∞—Ç–∞ –≤—Å—Ç—É–ø–ª–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ —Å–∏–ª—É | "2025-10-01"        |

#### –í–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞:

| ‚Ññ | –£—Å–ª–æ–≤–∏–µ                                                                 | –†–µ–∑—É–ª—å—Ç–∞—Ç                |
|---|-------------------------------------------------------------------------|--------------------------|
| 1 | title –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∏–ª–∏ –ø—É—Å—Ç                                              | ‚ùå missing_required_field |
| 2 | department –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∏–ª–∏ –Ω–µ —Å—Ç—Ä–æ–∫–∞                                    | ‚ùå invalid_type           |
| 3 | grade –Ω–µ –≤—Ö–æ–¥–∏—Ç –≤ —Å–ø–∏—Å–æ–∫ ["Junior", "Middle", "Senior", "Lead", "Head"] | ‚ùå invalid_enum_value     |
| 4 | effective_from –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç YYYY-MM-DD                              | ‚ùå invalid_date_format    |
| 5 | –í—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è –≤–∞–ª–∏–¥–Ω—ã                                           | ‚úÖ OK                     |

---

## 3Ô∏è‚É£ /produce/history ‚Üí –¢–æ–ø–∏–∫ hr.history

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:

–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –º–µ—Å—Ç–∞—Ö —Ä–∞–±–æ—Ç—ã —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞.

### –ü–æ–ª—è:

| –ü–æ–ª–µ     | –¢–∏–ø              | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ | –û–ø–∏—Å–∞–Ω–∏–µ                             | –ü—Ä–∏–º–µ—Ä                                       |
|----------|------------------|-------------|--------------------------------------|----------------------------------------------|
| company  | string           | ‚úÖ           | –ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏                    | "Acme Corp"                                  |
| position | string           | ‚úÖ           | –î–æ–ª–∂–Ω–æ—Å—Ç—å –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–µ–º –º–µ—Å—Ç–µ —Ä–∞–±–æ—Ç—ã | "QA Engineer"                                |
| period   | object           | ‚úÖ           | –û–±—ä–µ–∫—Ç —Å –ø–µ—Ä–∏–æ–¥–æ–º —Ä–∞–±–æ—Ç—ã             | { "from": "2022-07-01", "to": "2025-09-30" } |
| stack    | array of strings | ‚öôÔ∏è          | –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫                 | ["Python", "Pytest", "Postman"]              |

#### –í–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞:

| ‚Ññ | –£—Å–ª–æ–≤–∏–µ                                                | –†–µ–∑—É–ª—å—Ç–∞—Ç                |
|---|--------------------------------------------------------|--------------------------|
| 1 | company –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∏–ª–∏ –ø—É—Å—Ç                           | ‚ùå missing_required_field |
| 2 | period.from –∏–ª–∏ period.to –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç                  | ‚ùå missing_required_field |
| 3 | period.from –∏–ª–∏ period.to –Ω–µ YYYY-MM-DD                | ‚ùå invalid_date_format    |
| 4 | period.to < period.from (–¥–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è —Ä–∞–Ω—å—à–µ –Ω–∞—á–∞–ª–∞) | ‚ùå invalid_period         |
| 5 | stack –Ω–µ –º–∞—Å—Å–∏–≤ —Å—Ç—Ä–æ–∫                                  | ‚ùå invalid_type           |
| 6 | –í—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è –≤–∞–ª–∏–¥–Ω—ã                          | ‚úÖ OK                     |

---

## üî• –ü–æ–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö

| –°—Ü–µ–Ω–∞—Ä–∏–π                                                                                                     | –î–µ–π—Å—Ç–≤–∏–µ                                                                                                  |
|--------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------|
| –û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ –ø—Ä–æ–¥—é—Å–µ—Ä–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–µ–≤–µ—Ä–Ω—ã–π JSON)                                              | –í–æ–∑–≤—Ä–∞—Ç–∏—Ç—å HTTP 400 —Å —Å–æ–æ–±—â–µ–Ω–∏–µ–º –æ–± –æ—à–∏–±–∫–µ (FastAPI –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç).                            |
| –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ –∫–æ–Ω—Å—å—é–º–µ—Ä–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–∞—Ä—É—à–µ–Ω —Ñ–æ—Ä–º–∞—Ç –¥–∞—Ç—ã –∏–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ) | –°–æ–æ–±—â–µ–Ω–∏–µ –Ω–µ –∫–æ–º–º–∏—Ç–∏—Ç—å, –∑–∞–ø–∏—Å–∞—Ç—å –≤ —Ç–∞–±–ª–∏—Ü—É lab.kafka_dlq —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –ø—Ä–∏—á–∏–Ω—ã (error) –∏ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ payload. |
| –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ —Ç–æ–≥–æ –∂–µ message_id                                                                        | –°–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è, –Ω–æ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è (–¥–ª—è QA –Ω–∞–±–ª—é–¥–µ–Ω–∏—è).                                                |

---

## üß† –ü—Ä–∏–º–µ—Ä—ã –≤–∞–ª–∏–¥–Ω—ã—Ö –∏ –Ω–µ–≤–∞–ª–∏–¥–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π

### ‚úÖ –í–∞–ª–∏–¥–Ω–æ–µ /produce/personal

{
"message_id": "fd3f9edb-37a0-41ff-9a1e-7a3c9a5c820a",
"employee_id": "e-1024",
"first_name": "Anna",
"last_name": "Ivanova",
"birth_date": "1994-06-12",
"contacts": { "email": "anna@example.com", "phone": "+33-123-45-67" }
}

### ‚ùå –ù–µ–≤–∞–ª–∏–¥–Ω–æ–µ /produce/personal (–ø–ª–æ—Ö–∞—è –¥–∞—Ç–∞)

Alexey, [12.10.2025 9:59]
{
"message_id": "fd3f9edb-37a0-41ff-9a1e-7a3c9a5c820a",
"employee_id": "e-1024",
"first_name": "Anna",
"last_name": "Ivanova",
"birth_date": "94-06-12"
}

‚Üí –û—à–∏–±–∫–∞: invalid_date_format

---

### ‚úÖ –í–∞–ª–∏–¥–Ω–æ–µ /produce/position

{
"message_id": "9f1a7c6e-4402-40cf-b8db-55cb08fba4c1",
"employee_id": "e-1024",
"title": "QA Engineer",
"department": "Testing",
"grade": "Middle",
"effective_from": "2025-10-01"
}

### ‚ùå –ù–µ–≤–∞–ª–∏–¥–Ω–æ–µ /produce/position (–Ω–µ–≤–µ—Ä–Ω—ã–π –≥—Ä–µ–π–¥)

{
"message_id": "9f1a7c6e-4402-40cf-b8db-55cb08fba4c1",
"employee_id": "e-1024",
"title": "QA Engineer",
"department": "Testing",
"grade": "Expert"
}

‚Üí –û—à–∏–±–∫–∞: invalid_enum_value

---

### ‚úÖ –í–∞–ª–∏–¥–Ω–æ–µ /produce/history

{
"message_id": "b3e9e30a-4b8f-4c11-9f7b-0b1c41f25842",
"employee_id": "e-1024",
"company": "Acme Corp",
"position": "QA",
"period": { "from": "2022-07-01", "to": "2025-09-30" },
"stack": ["Python", "Pytest"]
}

### ‚ùå –ù–µ–≤–∞–ª–∏–¥–Ω–æ–µ /produce/history (–ø–µ—Ä–∏–æ–¥ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω)

{
"message_id": "b3e9e30a-4b8f-4c11-9f7b-0b1c41f25842",
"employee_id": "e-1024",
"company": "Acme Corp",
"position": "QA",
"period": { "from": "2025-09-30", "to": "2022-07-01" }
}

‚Üí –û—à–∏–±–∫–∞: invalid_period

---

## üíæ –õ–æ–≥–∏–∫–∞ –∑–∞–ø–∏—Å–∏ –≤ DLQ

–ï—Å–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –Ω–µ –ø—Ä–æ—Ö–æ–¥–∏—Ç –≤–∞–ª–∏–¥–∞—Ü–∏—é –Ω–∞ —É—Ä–æ–≤–Ω–µ –∫–æ–Ω—Å—å—é–º–µ—Ä–∞:

* –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü—É lab.kafka_dlq:

INSERT INTO lab.kafka_dlq (topic, msg_key, payload, error, received_at)
VALUES ('hr.history', 'e-1024', '{"..."}', 'invalid_period', now());

Here's a complete `README.md` you can drop into the repo. –û–Ω–æ –ø–æ–¥ –≤–∞—à —Ç–µ–∫—É—â–∏–π —Å—Ç–µ–∫ (Go + fasthttp + Sarama + Postgres),
–≤–∫–ª—é—á–∞–µ—Ç payload-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è, –∑–∞–ø—É—Å–∫, –º–∏–≥—Ä–∞—Ü–∏–∏, curl/HTTP, Postman, QA-—Å—Ü–µ–Ω–∞—Ä–∏–∏ –∏ —Ç—Ä–æ–±–ª—à—É—Ç–∏–Ω–≥.

---

# QA Kafka Lab ‚Äî HR Profiles Trainer

–£—á–µ–±–Ω—ã–π —Å—Ç–µ–Ω–¥ –¥–ª—è QA –ø–æ Kafka: –ø—É–±–ª–∏–∫–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏–π –ø—Ä–æ–¥—é—Å–µ—Ä–æ–º, –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–Ω—Å—å—é–º–µ—Ä–∞–º–∏, –∑–∞–ø–∏—Å—å –≤ Postgres –∏ —Ä—É—á–∫–∏ –¥–ª—è
—á—Ç–µ–Ω–∏—è/–ø—Ä–æ–≤–µ—Ä–∫–∏. –ü—Ä–æ–µ–∫—Ç —Å–æ–±—Ä–∞–Ω –Ω–∞ **Go (fasthttp + zerolog)**, **Kafka (Sarama)** –∏ **PostgreSQL**.

## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

* [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)
* [–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ payload](#—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è-–∫-payload)
* [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è)
* [–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è](#–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ-–æ–∫—Ä—É–∂–µ–Ω–∏—è)
* [–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç](#–±—ã—Å—Ç—Ä—ã–π-—Å—Ç–∞—Ä—Ç)
* [–ú–∏–≥—Ä–∞—Ü–∏–∏ (goose)](#–º–∏–≥—Ä–∞—Ü–∏–∏-goose)
* [API (HTTP)](#api-http)
* [Curl –ø—Ä–∏–º–µ—Ä—ã](#curl-–ø—Ä–∏–º–µ—Ä—ã)
* [Postman –∫–æ–ª–ª–µ–∫—Ü–∏—è](#postman-–∫–æ–ª–ª–µ–∫—Ü–∏—è)
* [QA —Å—Ü–µ–Ω–∞—Ä–∏–∏](#qa-—Å—Ü–µ–Ω–∞—Ä–∏–∏)
* [–¢—Ä–æ–±–ª—à—É—Ç–∏–Ω–≥](#—Ç—Ä–æ–±–ª—à—É—Ç–∏–Ω–≥)
* [–õ–∏—Ü–µ–Ω–∑–∏—è](#–ª–∏—Ü–µ–Ω–∑–∏—è)

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—Å–∏–∏:

* **HTTP API** (–ø–æ—Ä—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–µ–º—ã–π): CRUD –ø–æ –ë–î, –ø–ª—é—Å –ø—Ä–æ–¥—é—Å–µ—Ä-—Ä—É—á–∫–∏ (`/producer/*`) ‚Äî –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç —Å–æ–±—ã—Ç–∏—è –≤ Kafka.
* **Kafka Producer**: –æ–±—ë—Ä—Ç–∫–∞ –Ω–∞–¥ `sarama.SyncProducer`, —à–ª—ë—Ç –≤ —Ç–æ–ø–∏–∫–∏ `hr.personal`, `hr.positions`, `hr.history`.
* **(–¥–∞–ª—å—à–µ)** –ö–æ–Ω—Å—å—é–º–µ—Ä(—ã) ‚Äî –æ—Ç–¥–µ–ª—å–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã/—Å–µ—Ä–≤–∏—Å—ã (–ø—Ä–æ–µ–∫—Ç –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω –ø–æ–¥ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ; —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è –Ω–∏–∂–µ).
* **PostgreSQL**: —Ç–∞–±–ª–∏—Ü—ã `employee_profile`, `employment_history`, `kafka_events`, `kafka_dlq`.

Graceful shutdown: SIGINT/SIGTERM ‚Üí –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ –∏ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤.

---

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ payload

–ö—Ä–∞—Ç–∫–æ (–ø–æ–ª–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã –ø—Ä–∞–≤–∏–ª –ø—Ä–∏–≤–µ–¥–µ–Ω—ã –≤ –¢–ó –∏ –ø–æ–≤—Ç–æ—Ä–µ–Ω—ã –Ω–∏–∂–µ).

–û–±—â–∏–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è –¥–ª—è –≤—Å–µ—Ö `/producer/*`:

* `message_id` ‚Äî UUID (string). –ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å.
* `employee_id` ‚Äî string. –ö–ª—é—á –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ –∏ –∞–≥—Ä–µ–≥–∞—Ü–∏–∏.

### `/producer/personal` ‚Üí `hr.personal`

```json
{
  "message_id": "fd3f9edb-37a0-41ff-9a1e-7a3c9a5c820a",
  "employee_id": "e-1024",
  "first_name": "Anna",
  "last_name": "Ivanova",
  "birth_date": "1994-06-12",
  "contacts": {
    "email": "anna@example.com",
    "phone": "+33-123-45-67"
  }
}
```

–û—à–∏–±–∫–∏: `invalid_value`, `invalid_date_format`, `missing_required_field`, `invalid_email`, `invalid_type`.

### `/producer/position` ‚Üí `hr.positions`

```json
{
  "message_id": "9f1a7c6e-4402-40cf-b8db-55cb08fba4c1",
  "employee_id": "e-1024",
  "title": "QA Engineer",
  "department": "Testing",
  "grade": "Middle",
  "effective_from": "2025-10-01"
}
```

–û—à–∏–±–∫–∏: `missing_required_field`, `invalid_type`, `invalid_enum_value`, `invalid_date_format`.

### `/producer/history` ‚Üí `hr.history`

```json
{
  "message_id": "b3e9e30a-4b8f-4c11-9f7b-0b1c41f25842",
  "employee_id": "e-1024",
  "company": "Acme Corp",
  "position": "QA",
  "period": {
    "from": "2022-07-01",
    "to": "2025-09-30"
  },
  "stack": [
    "Python",
    "Pytest"
  ]
}
```

–û—à–∏–±–∫–∏: `missing_required_field`, `invalid_date_format`, `invalid_period`, `invalid_type`.

–ï—Å–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –Ω–µ–≤–∞–ª–∏–¥–Ω–æ —É –∫–æ–Ω—Å—å—é–º–µ—Ä–∞ ‚Äî **–Ω–µ –∫–æ–º–º–∏—Ç–∏—Ç—Å—è**, –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤ `kafka_dlq` (payload + –ø—Ä–∏—á–∏–Ω–∞), –ø–æ—Ç–æ–º –º–æ–∂–Ω–æ
—Ä–∞–∑–±–∏—Ä–∞—Ç—å.

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```
.
‚îú‚îÄ cmd/
‚îÇ  ‚îî‚îÄ qa-kafka-api/
‚îÇ     ‚îî‚îÄ main.go                # –∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞ (HTTP + –ø—Ä–æ–¥—é—Å–µ—Ä)
‚îú‚îÄ internal/
‚îÇ  ‚îú‚îÄ api/                      # fasthttp + handlers, middleware
‚îÇ  ‚îú‚îÄ config/                   # –∫–æ–Ω—Ñ–∏–≥-—Ñ–∞–π–ª—ã –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
‚îÇ  ‚îú‚îÄ dto/                      # DTO —Å—É—â–Ω–æ—Å—Ç–∏ (Profile, History, Events, DLQ)
‚îÇ  ‚îú‚îÄ exchange/
‚îÇ  ‚îÇ  ‚îî‚îÄ producer/              # HRProducer (sarama SyncProducer)
‚îÇ  ‚îî‚îÄ repository/
‚îÇ     ‚îú‚îÄ events/                # kafka_events / kafka_dlq
‚îÇ     ‚îú‚îÄ history/               # employment_history
‚îÇ     ‚îî‚îÄ profile/               # employee_profile
‚îú‚îÄ library/
‚îÇ  ‚îú‚îÄ pg/                       # pgxpool init + tracer
‚îÇ  ‚îî‚îÄ yamlreader/               # –∑–∞–≥—Ä—É–∑–∫–∞ YAML-–∫–æ–Ω—Ñ–∏–≥–∞
‚îú‚îÄ migrations/                  # goose –º–∏–≥—Ä–∞—Ü–∏–∏ (SQL)
‚îú‚îÄ config/
‚îÇ  ‚îî‚îÄ application-local.yaml    # –ø—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥–∞
‚îú‚îÄ docker-compose.yml           # (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ docker-–æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—é –ª–æ–∫–∞–ª—å–Ω–æ)
‚îú‚îÄ Makefile
‚îî‚îÄ README.md
```

---

## –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–í `config/application-local.yaml` (–∏–ª–∏ —á–µ—Ä–µ–∑ ENV):

```yaml
userAPI:
  port: 7011

postgres:
  conn: "postgres://user:pass@localhost:5432/qa_kafka_lab?sslmode=disable"

kafka:
  bootstrap: "localhost:9092"
  producerClientID: "qa-producer"
  topics:
    personal: "hr.personal"
    positions: "hr.positions"
    history: "hr.history"
```

ENV override (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):

```
CONFIG_PATH=./config/application-local.yaml
```

---

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –õ–æ–∫–∞–ª—å–Ω–æ (–±–µ–∑ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤)

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ PostgreSQL –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏:

```bash
make goose-up
```

2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ Kafka (–ª—é–±–æ–π —Å–ø–æ—Å–æ–±: –ª–æ–∫–∞–ª—å–Ω–æ / docker).

3. –°–æ–±–µ—Ä–∏—Ç–µ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–∏—Å:

```bash
make run
# –∏–ª–∏
go run ./cmd/qa-kafka-api
```

–õ–æ–≥–∏ –ø–æ–∫–∞–∂—É—Ç –∞–∫—Ç–∏–≤–Ω—ã–π –ø–æ—Ä—Ç –∏ bootstrap Kafka. Health: `GET /health` (–µ—Å–ª–∏ –¥–æ–±–∞–≤–ª–µ–Ω, —Å–º. –Ω–∏–∂–µ API).

### Docker Compose (–ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏)

–î–æ–±–∞–≤—å—Ç–µ `docker-compose.yml` –¥–ª—è Kafka/Postgres/Kafka UI (–Ω–µ –≤–∫–ª—é—á—ë–Ω —Å—é–¥–∞, –µ—Å–ª–∏ –Ω—É–∂–µ–Ω ‚Äî –∑–∞–≤–µ–¥–∏—Ç–µ —Å–≤–æ–π, —á—Ç–æ–±—ã –ø–æ—Ä—Ç—ã –Ω–µ
–∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤–∞–ª–∏). –ó–∞—Ç–µ–º:

```bash
docker compose up -d --build
docker compose logs -f
```

---

## –ú–∏–≥—Ä–∞—Ü–∏–∏ (goose)

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `goose` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω:

```bash
go install github.com/pressly/goose/v3/cmd/goose@latest
```

–ö–æ–º–∞–Ω–¥—ã:

```bash
make goose-status
make goose-up
make goose-down
```

`Makefile` –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –≤–∞—à–µ–π –ë–î. –ü—Ä–∏–º–µ—Ä:

```makefile
GOOSE_DRIVER=postgres
GOOSE_DBSTRING=postgres://user:pass@localhost:5432/qa_kafka_lab?sslmode=disable

goose-up:
	goose -dir ./migrations $(GOOSE_DRIVER) $(GOOSE_DBSTRING) up

goose-down:
	goose -dir ./migrations $(GOOSE_DRIVER) $(GOOSE_DBSTRING) down

goose-status:
	goose -dir ./migrations $(GOOSE_DRIVER) $(GOOSE_DBSTRING) status

run:
	go run ./cmd/qa-kafka-api
```

---

## API (HTTP)

–ë–∞–∑–∞ URL: `http://localhost:<port>` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `7011`, –µ—Å–ª–∏ —Ç–∞–∫ –∑–∞–¥–∞–Ω–æ –≤ –∫–æ–Ω—Ñ–∏–≥–µ).

### Producer

* `POST /producer/personal`
* `POST /producer/position`
* `POST /producer/history`

–¢–µ–ª–æ ‚Äî –∫–∞–∫ –≤ [–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ payload](#—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è-–∫-payload).

### Profiles (CRUD)

* `POST /profiles` ‚Äî —Å–æ–∑–¥–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å (–º–∏–Ω–∏–º—É–º `employee_id`; –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–æ–ª—è –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã)
* `PUT /profiles/{employee_id}` ‚Äî —á–∞—Å—Ç–∏—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
* `DELETE /profiles/{employee_id}`
* `GET /profiles?limit=50&offset=0`
* `GET /profiles/{employee_id}`

### History (CRUD)

* `POST /history`
* `PUT /history/{id}`
* `DELETE /history/{id}`
* `GET /history/{employee_id}?limit=50&offset=0`

### Events / DLQ (Read)

* `GET /events?limit=50&offset=0&pretty=1`
* `GET /dlq?limit=50&offset=0&pretty=1`

–ü–∞—Ä–∞–º–µ—Ç—Ä `pretty=1` –∫—Ä–∞—Å–∏–≤–æ —Ñ–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç –≤–ª–æ–∂–µ–Ω–Ω—ã–π `payload` (–µ—Å–ª–∏ –æ–Ω JSON).

---

## Curl –ø—Ä–∏–º–µ—Ä—ã

```bash
# PERSONAL
curl -sS -X POST http://localhost:7011/producer/personal \
 -H 'Content-Type: application/json' \
 -d '{
  "message_id":"fd3f9edb-37a0-41ff-9a1e-7a3c9a5c820a",
  "employee_id":"e-1024",
  "first_name":"Anna",
  "last_name":"Ivanova",
  "birth_date":"1994-06-12",
  "contacts":{"email":"anna@example.com","phone":"+33-123-45-67"}
 }' | jq

# POSITION
curl -sS -X POST http://localhost:7011/producer/position \
 -H 'Content-Type: application/json' \
 -d '{
  "message_id":"9f1a7c6e-4402-40cf-b8db-55cb08fba4c1",
  "employee_id":"e-1024",
  "title":"QA Engineer",
  "department":"Testing",
  "grade":"Middle",
  "effective_from":"2025-10-01"
 }' | jq

# HISTORY
curl -sS -X POST http://localhost:7011/producer/history \
 -H 'Content-Type: application/json' \
 -d '{
  "message_id":"b3e9e30a-4b8f-4c11-9f7b-0b1c41f25842",
  "employee_id":"e-1024",
  "company":"Acme Corp",
  "position":"QA",
  "period":{"from":"2022-07-01","to":"2025-09-30"},
  "stack":["Python","Pytest"]
 }' | jq

# –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–æ–±—ã—Ç–∏–π (payload –∫—Ä–∞—Å–∏–≤–æ)
curl -sS "http://localhost:7011/events?pretty=1&limit=20" | jq
```

---

## Postman –∫–æ–ª–ª–µ–∫—Ü–∏—è

–ì–æ—Ç–æ–≤–∞—è –∫–æ–ª–ª–µ–∫—Ü–∏—è —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏ —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤ –∏ —Ç–µ–ª –∑–∞–ø—Ä–æ—Å–æ–≤ (–≤–∫–ª—é—á–∞—è –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã–µ –∫–µ–π—Å—ã) ‚Äî *
*`postman/QA-Kafka-Lab.postman_collection.json`** –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏. –ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –≤ Postman –∏ –º–µ–Ω—è–π—Ç–µ `{{baseUrl}}` –Ω–∞
`http://localhost:7011`.

---

## QA —Å—Ü–µ–Ω–∞—Ä–∏–∏

1. **–ë–∞–∑–æ–≤—ã–π –æ–±–º–µ–Ω**: –æ—Ç–ø—Ä–∞–≤–∏—Ç—å `/producer/personal` ‚Üí —É–±–µ–¥–∏—Ç—å—Å—è –≤ –∑–∞–ø–∏—Å–∏ –≤ `employee_profile` –∏ –ø–æ—è–≤–ª–µ–Ω–∏–∏ —Å–æ–±—ã—Ç–∏—è –≤
   `kafka_events`.
2. **–ü–æ—Ä—è–¥–æ–∫**: –æ—Ç–ø—Ä–∞–≤–∏—Ç—å 3 —Å–æ–±—ã—Ç–∏—è –ø–æ–¥—Ä—è–¥ –ø–æ –æ–¥–Ω–æ–º—É `employee_id` ‚Üí –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—Ä—è–¥–æ–∫ –≤ `kafka_events` (
   partition/offset).
3. **–ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å**: –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–±—ã—Ç–∏–µ —Å —Ç–µ–º –∂–µ `message_id` ‚Üí —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤—Ç–æ—Ä–æ–π —Ä–∞–∑ –Ω–µ –∏–∑–º–µ–Ω—è–µ—Ç –∑–∞–ø–∏—Å—å/–Ω–µ
   –¥—É–±–ª–∏—Ä—É–µ—Ç.
4. **–û—à–∏–±–∫–∏**: –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–≤–µ–¥–æ–º–æ –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π JSON ‚Üí –∑–∞–ø–∏—Å—å –≤ `kafka_dlq` —Å –ø—Ä–∏—á–∏–Ω–æ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, `invalid_date_format`).
5. **–û—Ç—Å—Ç–∞–≤–∞–Ω–∏–µ**: –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Å—å—é–º–µ—Ä –∏—Å—Ç–æ—Ä–∏–∏, –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–∞—á–∫—É `history`, –∑–∞—Ç–µ–º –ø–æ–¥–Ω—è—Ç—å –∫–æ–Ω—Å—å—é–º–µ—Ä ‚Üí –æ–Ω –¥–æ—á–∏—Ç—ã–≤–∞–µ—Ç –∏
   –ø–∏—à–µ—Ç –≤ –ë–î.

---

## –¢—Ä–æ–±–ª—à—É—Ç–∏–Ω–≥

* **–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ ¬´–∑–∞–≤–∏—Å–∞–µ—Ç¬ª –ø—Ä–∏ –æ—Å—Ç–∞–Ω–æ–≤–∫–µ**
  –í `main.go` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —É–ø—Ä–æ—â—ë–Ω–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ: –ø–æ SIGINT/SIGTERM ‚Äî –æ—Ç–º–µ–Ω—è–µ—Ç—Å—è –∫–æ–Ω—Ç–µ–∫—Å—Ç, `errgroup.Wait()` –∏
  –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π `Shutdown()` HTTP-—Å–µ—Ä–≤–µ—Ä–∞. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –Ω–µ—Ç –∑–∞–≤–∏—Å—à–∏—Ö –≥–æ—Ä—É—Ç–∏–Ω –∏ —á—Ç–æ Kafka/DB –¥–æ—Å—Ç—É–ø–Ω—ã (–∏–Ω–∞—á–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
  –º–æ–≥—É—Ç –¥–µ—Ä–∂–∞—Ç—å –∑–∞–∫—Ä—ã—Ç–∏–µ —á—É—Ç—å –¥–æ–ª—å—à–µ).

* **payload –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è base64 –≤ /events**
  –í API –≤–∫–ª—é—á–µ–Ω–∞ –æ–ø—Ü–∏—è `?pretty=1`, –∞ –≤ DTO `payload` —Ö—Ä–∞–Ω–∏—Ç—Å—è –∫–∞–∫ `json.RawMessage` (—Äekomendu–µ–º). –¢–æ–≥–¥–∞ –≤ –æ—Ç–≤–µ—Ç–µ –±—É–¥–µ—Ç
  –∫—Ä–∞—Å–∏–≤–æ –æ—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π JSON –≤–º–µ—Å—Ç–æ base64.

* **Kafka –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞**
  –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `KAFKA_BOOTSTRAP` –∏ —á—Ç–æ –±—Ä–æ–∫–µ—Ä —Å–ª—É—à–∞–µ—Ç –≤–Ω—É—Ç—Ä–∏ –≤–∞—à–µ–π —Å–µ—Ç–∏/–Ω–∞ –Ω—É–∂–Ω–æ–º –∞–¥—Ä–µ—Å–µ. –î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ single-node Kafka
  –≤ Docker –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ `listeners/advertised.listeners`.

* **–ú–∏–≥—Ä–∞—Ü–∏–∏ –Ω–µ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è**
  –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç—Ä–æ–∫—É –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –≤ `Makefile`/ENV –∏ –Ω–∞–ª–∏—á–∏–µ `goose`. –ó–∞–ø—É—Å—Ç–∏—Ç–µ `make goose-status` –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏.

* **–î—É–±–ª–∏–∫–∞—Ç—ã —Å–æ–±—ã—Ç–∏–π**
  –î—É–±–ª–∏–∫–∞—Ç—ã ¬´—à—É–º–∞¬ª –≤ Kafka –Ω–æ—Ä–º–∞–ª—å–Ω—ã. –ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç—Å—è –ø—Ä–æ–≤–µ—Ä–∫–æ–π `message_id` –≤ `kafka_events` (–∏/–∏–ª–∏ –Ω–∞
  —É—Ä–æ–≤–Ω–µ –±–∏–∑–Ω–µ—Å-—Ç–∞–±–ª–∏—Ü).

---

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT. –î–µ–ª–∞–π—Ç–µ —Å –ø—Ä–æ–µ–∫—Ç–æ–º —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ ‚Äî —Ñ–æ—Ä–∫–∞–π—Ç–µ, –¥–æ–ø–æ–ª–Ω—è–π—Ç–µ –∏ –ª–æ–º–∞–π—Ç–µ (–≤ —É—á–µ–±–Ω—ã—Ö —Ü–µ–ª—è—Ö üòÑ).

---

### –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ: –ü–æ–ª–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ payload

(–°–≤–æ–¥–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã –∏–∑ –¢–ó, —á—Ç–æ–±—ã –≤—Å—ë –±—ã–ª–æ –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ.)

**–û–±—â–µ–µ:** `message_id` (UUID, string) –∏ `employee_id` (string) ‚Äî **–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã**. –û—à–∏–±–∫–∏: `missing_required_field`,
`invalid_type`.

**/producer/personal:**

* first_name, last_name ‚Äî –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã, –Ω–µ–ø—É—Å—Ç—ã–µ ‚Üí –∏–Ω–∞—á–µ `invalid_value`.
* birth_date ‚Äî `YYYY-MM-DD` ‚Üí –∏–Ω–∞—á–µ `invalid_date_format`.
* contacts ‚Äî –æ–±—ä–µ–∫—Ç –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω; –≤–Ω—É—Ç—Ä–∏ email (–ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏) –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å `@` ‚Üí –∏–Ω–∞—á–µ `invalid_email`.

**/producer/position:**

* title ‚Äî –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω ‚Üí `missing_required_field`.
* department ‚Äî string ‚Üí –∏–Ω–∞—á–µ `invalid_type`.
* grade ‚Äî enum: `Junior|Middle|Senior|Lead|Head` ‚Üí –∏–Ω–∞—á–µ `invalid_enum_value`.
* effective_from ‚Äî `YYYY-MM-DD` ‚Üí –∏–Ω–∞—á–µ `invalid_date_format`.

**/producer/history:**

* company ‚Äî –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω.
* period.{from,to} ‚Äî –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã –∏ `YYYY-MM-DD`.
* `to < from` ‚Üí `invalid_period`.
* stack ‚Äî –º–∞—Å—Å–∏–≤ —Å—Ç—Ä–æ–∫ ‚Üí –∏–Ω–∞—á–µ `invalid_type`.

**DLQ –∑–∞–ø–∏—Å—å (–ø—Ä–∏–º–µ—Ä):**

```sql
INSERT INTO kafka_dlq (topic, msg_key, payload, error, received_at)
VALUES ('hr.history', 'e-1024', '{"..."}'::jsonb, 'invalid_period', now());
```
